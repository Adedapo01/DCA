//-*-C++-*-

/*
 *      Author: peterstaar
 */

// elements of the cyclic group C_n(m)

#ifndef Cn_3D_H_
#define Cn_3D_H_

#include <cmath>
#include "group_action.h"

template<int ux, int uy, int uz, int n, int m>
class Cn_3D : public group_action<3>
{
public:

  typedef group_action<3>  base_type;
  typedef Cn_3D< ux, uy, uz,n,m>  this_type;

  Cn_3D(){};
  ~Cn_3D(){};

  const static double* matrix()
  {
    // rotation around an axis {ux,uy,uz} with angle th = 2*pi*n/m;

    const static double c = cos(2*M_PI*double(n)/double(m));
    const static double s = sin(2*M_PI*double(n)/double(m));

    const static double Ux = double(ux)/sqrt(double(ux*ux+uy*uy+uz*uz));
    const static double Uy = double(uy)/sqrt(double(ux*ux+uy*uy+uz*uz));
    const static double Uz = double(uz)/sqrt(double(ux*ux+uy*uy+uz*uz));
    
    const static double matrix[3*3] = { Ux*Ux + (1-Ux*Ux)*c, Ux*Uy*(1-c)+Uz*s    , Ux*Uz*(1-c)-Uy*s,
					Ux*Uy*(1-c)-Uz*s   , Uy*Uy + (1-Uy*Uy)*c , Uy*Uz*(1-c)+Ux*s,
					Ux*Uz*(1-c)+Uy*s   , Uy*Uz*(1-c)-Ux*s    , Uz*Uz+(1-Uz*Uz)*c};
    return matrix;
  }
};

#endif
